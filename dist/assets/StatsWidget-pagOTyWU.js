import{r as e,j as s}from"./react-vendor-HEOWGPvr.js";import{l as t}from"./utils-CJJeYulS.js";import{j as a,e as l,F as r,k as i,S as o,l as n}from"./icons-D19DpaoO.js";function d(){const[d,c]=e.useState(null),[x,m]=e.useState(!0),[u,p]=e.useState(!1);e.useEffect(()=>{h();const e=setInterval(h,3e4);return()=>clearInterval(e)},[]);const h=async()=>{var e,s,a,l,r,i,o;try{const t=await chrome.storage.local.get(["daily_usage","stats","user_data","streak"]),n=(new Date).toDateString(),d=(null==(e=(t.daily_usage||{})[n])?void 0:e.count)||0,x="premium"===(t.user_data||{}).subscriptionTier;c({today:{questions:d,limit:x?9999:10},allTime:{totalQuestions:(null==(s=t.stats)?void 0:s.totalExplanations)||0,topicsExplored:(null==(a=t.stats)?void 0:a.topicsExplored)||0},streak:{current:(null==(l=t.streak)?void 0:l.current)||0,longest:(null==(r=t.streak)?void 0:r.longest)||0},favorite:{complexity:(null==(i=t.stats)?void 0:i.favoriteComplexity)||"normal",count:(null==(o=t.stats)?void 0:o.favoriteComplexityCount)||0},isPremium:x})}catch(n){t.error("Failed to load stats:",n)}finally{m(!1)}};if(x)return s.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 rounded-xl p-4 border border-purple-200 animate-pulse",children:s.jsx("div",{className:"h-20 bg-white/50 rounded-lg"})});if(!d)return null;const g=d.today.questions/d.today.limit*100,b={"5yo":"ðŸŽˆ",normal:"ðŸ’¡",advanced:"ðŸŽ“"}[d.favorite.complexity];return s.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 rounded-xl border border-purple-200 overflow-hidden",children:[s.jsx("div",{className:"p-4 cursor-pointer hover:bg-white/30 transition-colors",onClick:()=>p(!u),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center",children:s.jsx(a,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Your Stats"}),s.jsxs("p",{className:"text-xs text-gray-600",children:[d.today.questions," questions today"]})]})]}),s.jsx(l,{className:"w-5 h-5 text-gray-400 transition-transform "+(u?"rotate-90":"")})]})}),u&&s.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[s.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Today's Questions"}),s.jsxs("span",{className:"text-sm font-bold text-purple-600",children:[d.today.questions," / ",d.isPremium?"âˆž":d.today.limit]})]}),!d.isPremium&&s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"h-2 rounded-full transition-all "+(g>=80?"bg-red-500":g>=50?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min(g,100)}%`}})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(r,{className:"w-4 h-4 text-orange-500"}),s.jsx("span",{className:"text-xs text-gray-600",children:"Streak"})]}),s.jsxs("div",{className:"text-xl font-bold text-gray-900",children:[d.streak.current,s.jsx("span",{className:"text-xs text-gray-500 ml-1",children:"days"})]})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(a,{className:"w-4 h-4 text-purple-500"}),s.jsx("span",{className:"text-xs text-gray-600",children:"Total"})]}),s.jsx("div",{className:"text-xl font-bold text-gray-900",children:d.allTime.totalQuestions})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(i,{className:"w-4 h-4 text-blue-500"}),s.jsx("span",{className:"text-xs text-gray-600",children:"Topics"})]}),s.jsx("div",{className:"text-xl font-bold text-gray-900",children:d.allTime.topicsExplored})]}),s.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(o,{className:"w-4 h-4 text-yellow-500"}),s.jsx("span",{className:"text-xs text-gray-600",children:"Favorite"})]}),s.jsx("div",{className:"text-xl font-bold text-gray-900",children:b})]})]}),!d.isPremium&&s.jsxs("button",{onClick:()=>{chrome.runtime.sendMessage({type:"TRACK_EVENT",payload:{event:"upgrade_cta_clicked",properties:{source:"stats_widget"}}}),chrome.tabs.create({url:"https://stupify.ai/pricing"})},className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-lg p-3 font-semibold transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl",children:[s.jsx(n,{className:"w-5 h-5"}),"Upgrade to Premium"]}),s.jsx("button",{onClick:()=>chrome.tabs.create({url:"https://stupify.ai/stats"}),className:"w-full text-sm text-purple-600 hover:text-purple-700 font-medium py-2",children:"View Full Dashboard â†’"})]})]})}export{d as default};
